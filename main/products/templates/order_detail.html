{% extends 'base.html' %}

{% load static %}

{% block encabezado %}
{% endblock %}

{% block contenido %}
<div class="pedidos-container">
    <div class="detail-header">
        <div>
            <h2>Pedido #{{ order.id }}</h2>
            <div class="subtitle">Detalles del pedido y datos del cliente</div>
        </div>
        {% if user.is_staff %}
        <div>
            <a href="{% url 'show_orders_admin' %}" class="btn-back">Volver a pedidos</a>
        </div>
        {% else %}
        <div>
            <a href="{% url 'my_orders' %}" class="btn-back">← Volver a pedidos</a>
        </div>
        {% endif %}
    </div>

    <div class="main-content-layout">
        <div class="top-row">
            <div class="info-card left-card">
                <h3>Información del pedido</h3>
                <div class="data-grid">
                    <div class="label">Identificador</div>
                    <div class="value">Pedido #{{ order.id }}</div>
                    <div class="label">Fecha realizada</div>
                    <div class="value">{{ order.date|date:"d/m/Y" }}</div>
                    <div class="label">Estado</div>
                    <div class="value">
                        <span class="status-tag">{{ order.status|upper }}</span>
                    </div>
                    <div class="label">Precio total</div>
                    <div class="value">{{ order.total_price }} €</div>
                </div>
            </div>

            <div class="info-card right-card">
                <h3>Datos del cliente</h3>
                <div class="data-grid">
                    <div class="label">Nombre y apellidos</div>
                    <div class="value">{{ order.full_name }}</div>
                    <div class="label">Teléfono</div>
                    <div class="value">{{ order.telephone }}</div>
                    <div class="label">Correo electrónico</div>
                    <div class="value">{{ order.contact_email }}</div>
                </div>
            </div>
        </div>

        <div class="info-card items-section full-width">
            <h3>Artículos</h3>
            <div class="item-list">
                {% for item in products %}
                    <div class="item-row">
                        {% if item.product.image %}
                            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="item-image">
                        {% endif %}
                        <div class="item-name"><strong>{{ item.product.name }}</strong></div>
                        <div class="item-qty">Cantidad: {{ item.quantity }}</div>
                    </div>
                {% empty %}
                    <p>No hay artículos en este pedido.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}